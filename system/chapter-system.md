# 章节系统

- Json转换工具将会按照 `chapterId` 填写的内容，将对话切分到数个章节Json文件中，每个章节Json文件的文件名格式为 `/Chapters/Chapter_<章节Id>.json`\
例如，所有 `chapterId` 为 `0-1` 的对话将会被切分到 `/Chapters/Chapter_0-1.json` 文件中。\
- `chapterId` 没有硬性的格式要求，可以自由使用数字、字母和下划线等字符（例如可以使用 `Slime_1` 等作为角色个人剧情，`Main_1_1` 作为主线剧情等，此处只是举一个例子），但是不要使用过于特殊字符（：？等），以免引起文件名错误。

## 连续章节的定义

如果有多行对话都属于同一个章节，可以直接留空， `charpterId` 为空的对话将会被合并到上一个章节中。\
例如：

| [chapterId]归属章节ID | [dialogText]对话内容文本 |
|-------------------|--------------------|
| `0-1`             | 这是 `0-1` 章节的第一句对话  |
|                   | 这是 `0-1` 章节的第二句对话  |
|                   | 这是 `0-1` 章节的第三句对话  |
|                   | 这是 `0-1` 章节的第四句对话  |
| `0-2`             | 这是 `0-2` 章节的第一句对话  |
|                   | 这是 `0-2` 章节的第二句对话  |


## 章节间的切换和跳转

当前执行的所有章节信息会存储在一个队列中，在章节进行过程中进行章节跳转主要通过 [行级脚本 载入章节LoadChapter](../scripts/line-scripts#loadchapter-载入章节)进行实现。

1. 当 `enqueue` 为 `true` 且 `priority` 为 `true` 时，将会插入新的章节并从下一句开始执行新的章节，新插入的章节执行完成后将会继续执行插入前的章节。
2. 当 `enqueue` 为 `true` 且 `priority` 为 `false` 时，读取的新章节将会添加到章节队列的末尾，等待当前章节执行完成后再执行新章节。
3. 当 `enqueue` 为 `false` 时，章节列表将会清空，并将当前章节替换为新的章节，新章节将会从头开始执行。

## 章节内对话的跳转

在章节内对话的跳转主要通过 [控制节点](../system/types-of-dialogue-node#控制节点) 进行。
